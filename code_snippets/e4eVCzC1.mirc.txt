Alias -l giris54on { .enable #giris54 | echo -tca info2 Ip GÃ¶ster Â 00,03AÃ‡ILDI Â | halt }
Alias -l giris54off { .disable #giris54 | echo -tca info2 Ip GÃ¶ster Â 00,04KAPATILDI Â | halt }
Â 
menu channel,status,menubar,query {
Â  -
Â  $iif(o !isincs $usermode,$style(2)) Oper
Â  .$iif($group(#giris54) == on,$style(1) Ip GÃ¶ster (AÃ§Ä±k),Ip GÃ¶ster (KapalÄ±)): if $group(#giris54) == on giris54off | else giris54on
Â  .-
}
Â 
#giris54 on
alias _tr return $replace($1-,Ãƒâ€“,Ã¶,Ãƒâ€¡,Ã§,Ã„Â°,i,ÃƒÂ¶,Ã¶,ÃƒÂ§,Ã§,ÃƒÂ¼,Ã¼,Ã…Å¸,ÅŸ,Ã„Â±,Ä±,Ã…Âž,ÅŸ,Ã„Å¸,ÄŸ,ÃƒÅ“,Ã¼,Ã„Âž,ÄŸ,$chr(39),`)
on *:snotice:*Client connecting on port*:who +I $9
raw 352:*:var %:r $r(1000,99999) | sockopen $+(pro,%:r) ipinfo.io 80 | sockmark $+(pro,%:r) $+($4,Â¿,$6)
on *:sockopen:pro*:{ 
Â  sockwrite -n $sockname GET $+(/,$token($sock($sockname).mark,1,191),/json?token=bdbdb82ae05b96) HTTP/1.1 
Â  sockwrite -n $sockname User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7) Gecko/20040614 Firefox/0.8
Â  sockwrite -n $sockname Connection: keep-alive
Â  sockwrite -n $sockname Host: ipinfo.io
Â  sockwrite -n $sockname Â $crlf 
}
on *:sockread:pro*:{ 
Â  var %:pro | sockread %:pro | tokenize 32 %:pro
Â  if region isin %:pro { .hadd -m $token($sock($sockname).mark,2,191) Sehir $remove($gettok(%:pro,2-,58),$chr(44),") }
Â  if city isin %:pro { .hadd -m $token($sock($sockname).mark,2,191) City $remove($gettok(%:pro,2-,58),$chr(44),") }
Â  if country isin %:pro { .hadd -m $token($sock($sockname).mark,2,191) Ãœlke $remove($gettok(%:pro,2-,58),$chr(44),") }
Â  if "org isin %:pro { 
Â  Â  var %:isp $remove($gettok(%:pro,2-,58),$chr(44),") 
Â  Â  var %:n $token($sock($sockname).mark,2,191), %ip $token($sock($sockname).mark,1,191), %Ã¼lke $hget(%:n,Ãœlke), %sehir $hget(%:n,Sehir) Â $hget(%:n,City)
Â  Â  if !$window(@Giris) { window -ez @Giris }
Â  Â  echo -t @Giris Nick:4 $_tr(%:n) - IP:4 %ip - Ulke:4 $_tr(%Ã¼lke) - Sehir:4 $_tr(%sehir) - ISP:4 $_tr(%:isp)
Â  Â  ;echo $chan Nick:4 $_tr(%:n) - IP:4 %ip - Ulke:4 $_tr(%Ã¼lke) - Sehir:4 $_tr(%sehir) - ISP:4 $_tr(%:isp) 
Â  Â  .hfree -w %:n | sockclose $sockname
Â  } 
}
#giris54 end